# Example 8.3

F, s = free_trunc_sig_alg_multiv(3,2)        # k = 3, N = 2
s1 = free_sig_from_sample(1,F)               # s₁⁽¹⁾ + s₁⁽²⁾ + s₁⁽³⁾ + 1
s2 = free_sig_from_sample(2,F)               # s₂⁽¹⁾ + s₂⁽²⁾ + s₂⁽³⁾ + 1
y = free_sig_bary(F)                         # y⁽¹⁾ + y⁽²⁾ + y⁽³⁾ + 1
g = QQ(1,2)*sum(log(inv(y)*si) for si in [s1,s2]) 

graded_component(g+y,1)               # f_1
# 1//2*s₁⁽¹⁾ + 1//2*s₂⁽¹⁾

graded_component(g+y,2)               # f_2
# -1//4*s₁⁽¹⁾^2 + 1//4*s₁⁽¹⁾*y⁽¹⁾ - 1//4*s₂⁽¹⁾^2 + 1//4*s₂⁽¹⁾*y⁽¹⁾ - 1//4*y⁽¹⁾*s₁⁽¹⁾ 
# - 1//4*y⁽¹⁾*s₂⁽¹⁾ + 1//2*y⁽¹⁾^2 + 1//2*s₁⁽²⁾ + 1//2*s₂⁽²⁾

graded_component(g+y,3)               # f_3
# 1//6*s₁⁽¹⁾^3 - 1//6*s₁⁽¹⁾^2*y⁽¹⁾ + 1//12*s₁⁽¹⁾*y⁽¹⁾*s₁⁽¹⁾ - 1//12*s₁⁽¹⁾*y⁽¹⁾^2 
# + 1//6*s₂⁽¹⁾^3 - 1//6*s₂⁽¹⁾^2*y⁽¹⁾ + 1//12*s₂⁽¹⁾*y⁽¹⁾*s₂⁽¹⁾ - 1//12*s₂⁽¹⁾*y⁽¹⁾^2 
# + 1//12*y⁽¹⁾*s₁⁽¹⁾^2 - 1//12*y⁽¹⁾*s₁⁽¹⁾*y⁽¹⁾ + 1//12*y⁽¹⁾*s₂⁽¹⁾^2 
# - 1//12*y⁽¹⁾*s₂⁽¹⁾*y⁽¹⁾ + 1//6*y⁽¹⁾^2*s₁⁽¹⁾ + 1//6*y⁽¹⁾^2*s₂⁽¹⁾ - 1//3*y⁽¹⁾^3 
# - 1//4*s₁⁽¹⁾*s₁⁽²⁾ + 1//4*s₁⁽¹⁾*y⁽²⁾ - 1//4*s₁⁽²⁾*s₁⁽¹⁾ + 1//4*s₁⁽²⁾*y⁽¹⁾ 
# - 1//4*s₂⁽¹⁾*s₂⁽²⁾ + 1//4*s₂⁽¹⁾*y⁽²⁾ - 1//4*s₂⁽²⁾*s₂⁽¹⁾ + 1//4*s₂⁽²⁾*y⁽¹⁾ 
# - 1//4*y⁽¹⁾*s₁⁽²⁾ - 1//4*y⁽¹⁾*s₂⁽²⁾ + 1//2*y⁽¹⁾*y⁽²⁾ - 1//4*y⁽²⁾*s₁⁽¹⁾ 
# - 1//4*y⁽²⁾*s₂⁽¹⁾ + 1//2*y⁽²⁾*y⁽¹⁾ + 1//2*s₁⁽³⁾ + 1//2*s₂⁽³⁾
